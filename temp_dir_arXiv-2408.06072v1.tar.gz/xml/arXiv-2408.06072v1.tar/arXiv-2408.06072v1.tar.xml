<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE std SYSTEM 'classes.dtd'>
<!-- Translated from latex by tralics 2.14.4, date: 2024/08/26-->
<std>
<p>promptbox[1][]
breakable,
title=1,
colback=gray!5,
colframe=black,
colbacktitle=gray!15,
coltitle=black,
fonttitle=<hi rend='bold'>,
bottomrule=1.5pt,
toprule=1.5pt,
leftrule=1pt,
rightrule=1pt,
arc=0pt,
outer arc=0pt,
enhanced,
before upper= </hi></p>
<p>basicstyle=<hi rend='tt'>,
breaklines=true,
breakatwhitespace=false,
columns=flexible,
keepspaces=true,
showspaces=false,
showstringspaces=false,
showtabs=false,
tabsize=4,
xleftmargin=0pt,
xrightmargin=0pt
</hi></p>
<maketitle><title>
<figure rend='inline' width='128.1013pt' file='images/logo' extension='png'/>
A Text-to-Video Diffusion Model with Expert Transformer</title><author>Zhuoyi Yang*   Jiayan Teng*    Wendi Zheng   Ming Ding   Shiyu Huang    Jiazheng Xu    <hi rend='bold'>Yuanming Yang    Xiaohan Zhang    Xiaotao Gu
   Guanyu Feng    Da Yin    Wenyi Hong    </hi> <hi rend='bold'> Weihan Wang    Yean Cheng    Yuxuan Zhang    Ting Liu    Bin Xu    Yuxiao Dong    Jie Tang</hi> <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow/> <mn>1</mn> </msup></math><texmath>^1</texmath></formula>Zhipu AI      <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><msup><mrow/> <mn>2</mn> </msup></math><texmath>^2</texmath></formula>Tsinghua University <xref url='https://github.com/THUDM/CogVideo'>https://github.com/THUDM/CogVideo</xref>
</author><date>2024/08/26 15:28:28</date></maketitle><p>*equal contributions. Core contributors: Zhuoyi, Jiayan, Wendi, Ming, and Shiyu.
{yangzy22,tengjy20}@mails.tsinghua.edu.cn, {yuxiaod,jietang}@tsinghua.edu.cn


We introduce CogVideoX, a large diffusion transformer model capable of generating videos conditioned on text prompts. It applies a 3D VAE and a 3D transformer based on Expert Adaptive LayerNorm. Employing a progressive training technique, the model is able to generate coherent long-duration videos characterized by significant motion. Additionally, we propose a complete large-scale data processing pipeline, including various data cleaning strategies and video re-caption method, resulting in better generation quality and improved semantic alignment. Finally, CogVideoX achieves state-of-the-art performance across multiple machine metrics and human evaluations.</p>
<div0 id-text='1' id='cid1'><head>Introduction</head>
<p>The rapid development of text-to-video models has been phenomenal, driven by both the Transformer architecture <cit><ref target='bid0'/></cit> and diffusion model <cit><ref target='bid1'/></cit>.
Early attempts to pretrain and scale Transformers to generate videos from text have shown great promise, such as CogVideo <cit><ref target='bid2'/></cit> and Phenaki <cit><ref target='bid3'/></cit>.
Meanwhile, diffusion models have recently made exciting advancements in multimodal generation, including video generation <cit><ref target='bid4'/></cit>, <cit><ref target='bid5'/></cit>.
By using Transformers as the backbone of diffusion models, i.e., Diffusion Transformers (DiT) <cit><ref target='bid6'/></cit>, text-to-video generation has reached groundbreaking levels, as evidenced by the impressive Sora showcases <cit><ref target='bid7'/></cit>.</p>
<p>Despite these rapid advancements in DiTs, it remains technically unclear how to achieve long-term consistent video generation.
Challenges such as efficiently modeling video data, effectively aligning videos with text semantics, as well as constructing the high-quality text-video pairs for model training have thus far been largely unaddressed.</p>
<p>In this work, we train and introduce CogVideoX, a set of large-scale diffusion transformer models designed for generating long-term, temporally consistent videos.
We address the challenges mentioned above by developing a 3D variational Autoencoder (VAE), an expert Transformer, and a video data filtering and captioning pipeline, respectively.
First, to efficiently consume video data, we design and train a 3D causal VAE that compresses the video along both spatial and temporal dimensions.
Compared to unfolding a video into a one-dimensional sequence in the pixel space, this strategy helps significantly reduce the sequence length and associated training compute.
Unlike previous video models <cit><ref target='bid8'/></cit> that often use a 2D VAE to encode each frame separately, the 3D VAE helps prevent flicker in the generated videos, that is, ensuring continuity among frames.</p>
<figure width='298.8987pt' file='images/bench_eval9' extension='png' id-text='1' id='uid1'><head>The performance of openly-accessible text-to-video models in different aspects.</head>
</figure>
<p>Second, to improve the alignment between videos and texts, we propose an expert Transformer with expert adaptive LayerNorm to facilitate the fusion between the two modalities.
To ensure the temporal consistency in video generation and capture large-scale motions, we propose to use 3D full attention to comprehensively model the video along both temporal and spatial dimensions.</p>
<p>Third, as most video data available online lacks accurate textual descriptions, we develop a video captioning pipeline capable of accurately describing video content.
This pipeline is used to generate new textual descriptions for all video data, which significantly enhances CogVideoX's ability to grasp precise semantic understanding.</p>
<p>In addition, we adopt and design progressive training techniques, including mixed-duration training and resolution progressive training, to further enhance the generation performance and stability of CogVideoX. Furthermore, we propose Explicit Uniform Sampling, which stablizes the training loss curve and accelerates convergence by setting different timestep sampling intervals on each data parallel rank.</p>
<p>Both machine and human evaluations suggest that CogVideoX outperforms well-known public models.
Figure <ref target='uid1'/> shows the performance of CogVideoX in different aspects.</p>
<p>CogVideoX is an ongoing attempt to advance text-to-video generation.
To facilitate further developments, we open-source the model weight of part of CogVideoX and the 3D VAE, and we plan to release future and larger models as well.
Now open-sourced CogVideoX is capable of generating 720<formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mo>&#xD7;</mo></math><texmath>\times </texmath></formula>480 videos of six seconds with eight frames per second.
It can be publicly accessed from <xref url='https://github.com/THUDM/CogVideo'>https://<allowbreak/>github.<allowbreak/>com/<allowbreak/>THUDM/<allowbreak/>CogVideo</xref>.</p>
</div0>
<div0 id-text='2' id='cid2'><head>The CogVideoX Architecture</head>
<p>In the section, we present the CogVideoX model.
Figure <ref target='uid2'/> illustrates the overall architecture.
Given a pair of video and text input, we design a <hi rend='bold'>3D causal VAE</hi> to compress the video into the latent space, and the latents are then patchified and unfolded into a long sequence denoted as <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><msub><mi>z</mi> <mtext>vision</mtext> </msub></math><texmath>z_{\text{vision}}</texmath></formula>.
Simultaneously, we encode the textual input into text embeddings <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><msub><mi>z</mi> <mtext>text</mtext> </msub></math><texmath>z_{\text{text}}</texmath></formula> using T5 <cit><ref target='bid9'/></cit>.
Subsequently, <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><msub><mi>z</mi> <mtext>text</mtext> </msub></math><texmath>z_{\text{text}}</texmath></formula> and <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><msub><mi>z</mi> <mtext>vision</mtext> </msub></math><texmath>z_{\text{vision}}</texmath></formula> are concatenated along the sequence dimension.
The concatenated embeddings are then fed into a stack of <hi rend='bold'>expert transformer</hi> blocks.
Finally, the model output are unpatchified to restore the original latent shape, which is then decoded using a 3D causal VAE decoder to reconstruct the video.
We illustrate the technical design of the 3D causal VAE and expert transfomer in detail.</p>
<figure width='298.8987pt' file='images/transformer' extension='png' id-text='2' id='uid2' place='h'><head><hi rend='bold'>The overall architecture of CogVideoX.</hi></head>
</figure>
<div1 id-text='2.1' id='uid3'><head>3D Causal VAE</head>
<p>Videos encompass not only spatial information but also substantial temporal information, usually resulting in orders of magnitude more data volumes than images.
To tackle the computational challenge of modeling video data, we propose to implement a video compression module based on 3D Variational Autoencoders (3D VAEs) <cit><ref target='bid10'/></cit>.
The idea is to incorporate three-dimentional convolutions to compress videos both spatially and temporally.
This can help achieve a higher compression ratio with largely improved quality and continuity of video reconstruction when compared to previous image VAEs <cit><ref target='bid11'/></cit>, <cit><ref target='bid12'/></cit>.</p>
<figure width='427.0pt' file='images/3dvae_combined' extension='jpg' id-text='3' id='uid4' place='h'><head>(a) The structure of the 3D VAE in CogVideoX. It comprises an encoder, a decoder and a latent space regularizer, achieving a 4<formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mo>&#xD7;</mo></math><texmath>\times </texmath></formula>8<formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mo>&#xD7;</mo></math><texmath>\times </texmath></formula>8 compression from pixels to the latents. (b) The context parallel implementation on the temporally causal convolution.</head>
</figure>
<p>Figure <ref target='uid4'/> (a) shows the structure of the proposed 3D VAE.
It comprises an encoder, a decoder and a latent space regularizer.
The Gaussian latent space is constrained by a Kullback-Leibler (KL) regularizer.
The encoder and decoder consist of four symmetrically arranged stages, respectively performing 2<formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mo>&#xD7;</mo></math><texmath>\times </texmath></formula> downsampling and upsampling by the interleaving of ResNet block stacked stages.
The first two rounds of downsampling and the last two upsampling involve both the spatial and temporal dimensions, while the last round only applies spatial sampling.
This enables the 3D VAE to achieve a 4<formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mo>&#xD7;</mo></math><texmath>\times </texmath></formula> compression in the temporal dimension and an 8<formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mo>&#xD7;</mo></math><texmath>\times </texmath></formula>8 compression in the spatial dimension.
In total, this achieves a 4<formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mo>&#xD7;</mo></math><texmath>\times </texmath></formula>8<formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mo>&#xD7;</mo></math><texmath>\times </texmath></formula>8 compression from pixels to the latents.</p>
<p>We adopt the temporally causal convolution <cit><ref target='bid10'/></cit>, which places all the paddings at the beginning of the convolution space, as shown in Figure <ref target='uid4'/> (b).
This ensures the future information not to influence the present or past predictions.
Given that processing videos with a large number of frames introduces excessive GPU memory usage, we apply context parallel at the temporal dimension for 3D convolution to distribute computation among multiple devices.
As illustrated by Figure <ref target='uid4'/> (b), due to the causal nature of the convolution, each rank simply sends a segment of length <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>k</mi><mo>-</mo><mn>1</mn></mrow></math><texmath>k-1</texmath></formula> to the next rank, where <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>k</mi></math><texmath>k</texmath></formula> indicates the temporal kernel size.
This results in relatively low communication overhead.</p>
<p>During actual implementation, we first train a 3D VAE on lower resolutions and fewer frames to save computation.
We observe that the encoding of larger resolution generalizes naturally, while extending the number of frames to be encoded does not work as seamlessly.
Therefore, we conduct a two-stage training process by first training on short videos and finetuning by context parallel on long videos.
Both stages of training utilize a weighted combination of the L2 loss, LPIPS <cit><ref target='bid13'/></cit> perceptual loss, and GAN loss from a 3D discriminator.</p>
</div1>
<div1 id-text='2.2' id='uid5'><head>Expert Transformer</head>
<p>We introduce the design choices in Transformer for CogVideoX, including the patching, positional embedding, and attention strategies for handling the text-video data effectively and efficiently.</p>
<div3 id-text='2.2.0.1' id='uid6'><head>Patchify.</head>
<p>The 3D causal VAE encodes a video latent vector of shape <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>T</mi><mo>&#xD7;</mo><mi>H</mi><mo>&#xD7;</mo><mi>W</mi><mo>&#xD7;</mo><mi>C</mi></mrow></math><texmath>T \times H \times W \times C</texmath></formula>, where <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>T</mi></math><texmath>T</texmath></formula> represents the number of frames, <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>H</mi></math><texmath>H</texmath></formula> and <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>W</mi></math><texmath>W</texmath></formula> represent the height and width of each frame, <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>C</mi></math><texmath>C</texmath></formula> represents the channel number, respectively.
The video latents are then patchified along the spatial dimensions, generating sequence <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><msub><mi>z</mi> <mtext>vision</mtext> </msub></math><texmath>z_{\text{vision}}</texmath></formula> of length <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>T</mi><mo>&#xB7;</mo><mfrac><mi>H</mi> <mi>p</mi></mfrac><mo>&#xB7;</mo><mfrac><mi>W</mi> <mi>p</mi></mfrac></mrow></math><texmath>T\cdot \frac{H}{p} \cdot \frac{W}{p}</texmath></formula>.
Note that, we do not patchify along the temporal dimension in order to enable joint training of images and videos.</p>
</div3>
<div3 id-text='2.2.0.2' id='uid7'><head>3D-RoPE.</head>
<p>Rotary Position Embedding (RoPE) <cit><ref target='bid14'/></cit> is a relative positional encoding that has been demonstrated to capture inter-token relationships effectively in LLMs, particularly excelling in modeling long sequences.
To adapt to video data, we extend the original RoPE to 3D-RoPE.
Each latent in the video tensor can be represented by a 3D coordinate <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mo>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo>,</mo><mi>t</mi><mo>)</mo></mrow></math><texmath>(x, y, t)</texmath></formula>.
We independently apply 1D-RoPE to each dimension of the coordinates, each occupying <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn><mo>/</mo><mn>8</mn></mrow></math><texmath>3/8</texmath></formula>, <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>3</mn><mo>/</mo><mn>8</mn></mrow></math><texmath>3/8</texmath></formula>, and <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mn>2</mn><mo>/</mo><mn>8</mn></mrow></math><texmath>2/8</texmath></formula> of the hidden states' channel.
The resulting encoding is then concatenated along the channel dimension to obtain the final 3D-RoPE encoding.</p>
<p>We empirically examine the use of RoPE.
Figure <ref target='uid8'/> (a)shows the comparison between 3D RoPE and sinusoidal absolute position encoding.
We can observe that the loss curve using 3D RoPE converges significantly faster than that with sinusoidal encoding.
We further compare the use of 3D RoPE alone against the combination of 3D RoPE and learnable absolute position embedding.
Figure <ref target='uid8'/> (b) indicates that the loss curves of both methods converge almost identically.
Therefore, we choose to use 3D RoPE alone for simplicity.</p>
<figure rend='array' id-text='4' id='uid8' place='h'><head>RoPE vs. Sinusoidal</head>
<p><table rend='inline'><row><cell id-text='4.1' id='uid9'>0.46</cell><cell id-text='4.2' id='uid10'>0.48</cell><cell id-text='4.3' id='uid11'>0.46</cell><cell id-text='4.4' id='uid12'>0.48</cell></row><row><cell>(a) b</cell><cell>(b) b</cell><cell>(c) b</cell><cell>(d) b</cell></row></table></p><unexpected><figure rend='inline' width='427.0pt' file='images/ab_sr' extension='png'/><figure rend='inline' width='427.0pt' file='images/ab_rl' extension='png'/><caption>RoPE vs. RoPE + Learnable</caption><figure rend='inline' width='427.0pt' file='images/ab_ex' extension='png'/><caption>Expert Ada. LN vs. Expert Ada. LN + MLP</caption><figure rend='inline' width='427.0pt' file='images/ab_us' extension='png'/><caption>Uniform Sampling vs. No Uniform Sampling</caption><caption>Training loss curve of different ablations.</caption></unexpected></figure>
</div3>
<div3 id-text='2.2.0.3' id='uid13'><head>Expert Transformer Block.</head>
<p>We concatenate the embeddings of both text and video at the input stage to better align visual and semantic information.
However, the feature spaces of these two modalities differ significantly, and their embeddings may even have different numerical scales.
To better process them within the same sequence, we employ the Expert Adaptive Layernorm to handle each modality independently.
As shown in Figure <ref target='uid2'/>, following DiT <cit><ref target='bid6'/></cit>, we use the timestep <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math><texmath>t</texmath></formula> of the diffusion process as the input to the modulation module.
Then, the Vision Expert Adaptive Layernorm (Vison Expert AdaLN) and Text Expert Adaptive Layernorm (Text Expert AdaLN) apply this modulation mechanism to the vision hidden states and text hidden states, respectively.
This strategy promotes the alignment of feature spaces across two modalities while minimizing additional parameters.</p>
<p>To verify the adoption of Expert Adaptive Layernorm, we experiment with different ways of incorporating experts: expert LayerNorm and MLP, and expert Layernorm only.
Our experiments find that adding expert MLP does not effectively accelerate the model's convergence (Cf. Figure <ref target='uid8'/> (c)).
To reduce the model parameters, we only choose to use Expert Adaptive Layernorm.</p>
<figure width='298.8987pt' file='images/attention' extension='jpg' id-text='5' id='uid14' place='h'><head>The separated spatial and temporal attention makes it challenging to handle the large motion between adjacent frames.
In the figure, the head of the person in frame <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></math><texmath>i+1</texmath></formula> cannot directly attend to the head in frame <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>i</mi></math><texmath>i</texmath></formula>.
Instead, visual information can only be implicitly transmitted through other background patches.
This can lead to inconsistency issues in the generated videos.</head>
</figure>
</div3>
<div3 id-text='2.2.0.4' id='uid15'><head>3D Full Attention.</head>
<p>Previous works <cit><ref target='bid4'/></cit>, <cit><ref target='bid15'/></cit> often employ separated spatial and temporal attention to reduce computational complexity and facilitate fine-tuning from text-to-image models.
However, as illustrated in Figure <ref target='uid14'/>, this separated attention approach requires extensive implicit transmission of visual information, significantly increasing the learning complexity and making it challenging to maintain the consistency of large-movement objects.
Considering the great success of long-context training in LLMs <cit><ref target='bid16'/></cit>, <cit><ref target='bid17'/></cit>, <cit><ref target='bid18'/></cit> and the efficiency of FlashAttention <cit><ref target='bid19'/></cit>, we propose a 3D text-video hybrid attention mechanism.
This mechanism not only achieves better results but can also be easily adapted to various parallel acceleration methods.</p>
</div3></div1>
<div1 id-text='2.3' id='uid16'><head>Data</head>
<p>We construct a collection of relatively high-quality video clips with text descriptions through video filters and recaption models. After filtering, approximately 35M single-shot clips remain, with each clip averaging about 6 seconds.</p>
<div3 id-text='2.3.0.5' id='uid17'><head>Video Filtering.</head>
<p>Video generation models need to learn the dynamic information of the world, but unfiltered video data is of highly noisy distribution, primarily due to two reasons:
First, videos are human-created, and artificial editing may distort the authentic dynamic information;
Second, the quality of videos can significantly drop due to issues during filming, such as camera shakes and substandard equipment.</p>
<p>In addition to the intrinsic quality of the videos, we also consider how well the video data supports model training.
Videos with minimal dynamic information or lacking connectivity in dynamic aspects are considered detrimental.
Consequently, we have developed a set of negative labels, which include:</p>
<list type='simple'>
<item id-text='1' id='uid18'><p noindent='true'><hi rend='bold'>Editing</hi>: Videos that have undergone obvious artificial processing, such as re-editing and special effects, causing degradation of the visual integrity.</p>
</item>
<item id-text='2' id='uid19'><p noindent='true'><hi rend='bold'>Lack of Motion Connectivity</hi>: Video segments with image transitions lacking motion connectivity, commonly seen in videos artificially spliced or edited from images.</p>
</item>
<item id-text='3' id='uid20'><p noindent='true'><hi rend='bold'>Low Quality</hi>: Poorly shot videos with unclear visuals or excessive camera shake.</p>
</item>
<item id-text='4' id='uid21'><p noindent='true'><hi rend='bold'>Lecture Type</hi>: Videos focusing primarily on a person continuously talking with minimal effective motion, such as educational content, lectures, and live-streamed discussions.</p>
</item>
<item id-text='5' id='uid22'><p noindent='true'><hi rend='bold'>Text Dominated</hi>: Videos containing a substantial amount of visible text or primarily focusing on textual content.</p>
</item>
<item id-text='6' id='uid23'><p noindent='true'><hi rend='bold'>Noisy Screenshots</hi>: Noisy videos recorded from phone or computer screens.</p>
</item></list>
<p>We sample 20,000 video data samples and label the presence of negative tags in each of them.
By using these annotations, we train several filters based on video-llama <cit><ref target='bid20'/></cit> to screen out low-quality video data.</p>
<p>In addition, we calculate the optical flow scores and image aesthetic scores of all training videos and dynamically adjust the threshold ranges during training to ensure the fluency and aesthetic quality of the generated videos.</p>
</div3>
<div3 id-text='2.3.0.6' id='uid24'><head>Video Caption.</head>
<p>Typically, most video data does not come with corresponding descriptive text, so it is necessary to convert the video data into textual descriptions to provide the essential training data for text-to-video models.
Currently, there are some video caption datasets available, such as Panda70M <cit><ref target='bid21'/></cit>, COCO Caption <cit><ref target='bid22'/></cit>, and WebVid <cit><ref target='bid23'/></cit>.
However, the captions in these datasets are usually very short and fail to describe the video's content comprehensively.</p>
<figure width='427.0pt' file='images/pipeline' extension='jpg' id-text='6' id='uid25' place='h'><head>The pipeline for dense video caption data generation. In this pipeline, we generate short video captions with the Panda70M model, extract frames to create dense image captions, and use GPT-4 to summarize these into final video captions. To accelerate this process, we fine-tuned a Llama 2 model with the GPT-4 summaries.</head>
</figure>
<p>To generate high-quality video caption data, we establish a <hi rend='it'>Dense Video Caption Data Generation</hi>
pipeline, as detailed in Figure <ref target='uid25'/>.
The idea is to generate video captions from image captions.</p>
<p>First, we use the Panda70M video captioning model <cit><ref target='bid21'/></cit> to generate short captions for the videos.
Then, we employ the image recaptioning model CogVLM <cit><ref target='bid24'/></cit> used in Stable Diffusion 3 <cit><ref target='bid25'/></cit> and CogView3 <cit><ref target='bid26'/></cit> to create dense image captions for each of the frames within a video.
Subsequently, we use GPT-4 to summarize all the image captions to produce the final video caption.
To accelerate the generation from image captions to video captions, we fine-tune a Llama2 model <cit><ref target='bid27'/></cit> using the summary data generated by GPT-4 <cit><ref target='bid28'/></cit>, enabling large-scale video caption data generation. Additional details regarding the video caption data generation process can be found in Appendix <ref/>.</p>
<p>The pipeline above generates the caption data that is used to trained the CogVideoX model introduced in this report.
To further accelerate video recaptioning, we also fine-tune an end-to-end video understanding model CogVLM2-Caption, based on the CogVLM2-Video<note id-text='1' id='uid26' place='foot'>The CogVLM2-Video model weight is openly available at <xref url='https://github.com/THUDM/CogVLM2'>https://<allowbreak/>github.<allowbreak/>com/<allowbreak/>THUDM/<allowbreak/>CogVLM2</xref>.</note> and Llama3 <cit><ref target='bid16'/></cit>, by using the dense caption data generated from the aforementioned pipeline.
The video caption data generated by CogVLM2-Caption is used to train the next generation of CogVideoX.
Examples of video captions generated by this end-to-end CogVLM2-Caption model are shown in Appendix <ref/>.
In Appendix <ref/>, we also present some examples of video generation where a video is first input into CogVLM2-Caption to generate captions, which are then used as input for CogVideoX to generate new videos, effectively achieving video-to-video generation.</p>
<figure width='427.0pt' file='images/CogVideoX' extension='png' id-text='7' id='uid27' place='ht'><head>The diagram of mixed-duration training and Frame Pack. To fully utilize the data and enhance the model's generalization capability, we train with videos of different durations within the same batch.</head>
</figure>
</div3></div1></div0>
<div0 id-text='3' id='cid3'><head>Training CogVideoX</head>
<p>We mix images and videos during training, treating each image as a single-frame video.
Additionally, we employ progressive training from the resolution perspective.
For the diffusion setting, we adopt v-prediction <cit><ref target='bid29'/></cit> and zero SNR <cit><ref target='bid30'/></cit>, following the noise schedule used in LDM <cit><ref target='bid11'/></cit>.
During diffusion training for timestep sampling, we also employ an explicit uniform timestep sampling method, which benefits training stability.</p>
<div1 id-text='3.1' id='uid28'><head>Frame Pack</head>
<p>Previous video training methods often involve joint training of images and videos with fixed number of frames <cit><ref target='bid4'/></cit>, <cit><ref target='bid8'/></cit>.
However, this approach usually leads to two issues:
First, there is a significant gap between the two input types using bidirectional attention, with images having one frame while videos having dozens of frames.
We observe that models trained this way tend to diverge into two generative modes based on the token count and not to have good generalizations. Second, to train with a fixed duration, we have to discard short videos and truncate long videos, which prevents full utilization of the videos of varying number of frames.</p>
<p>To address these issues, we choose mixed-duration training, which means training videos of different lengths together.
However, inconsistent data shapes within the batch make training difficult.
Inspired by Patch'n Pack <cit><ref target='bid31'/></cit>, we place videos of different lengths into the same batch to ensure consistent shapes within each batch, a method we refer to as <hi rend='it'>Frame Pack</hi>. The process is illustrated in Figure <ref target='uid27'/>.</p>
</div1>
<div1 id-text='3.2' id='uid29'><head>Resolution Progressive Training</head>
<p>The training pipeline of CogVideoX is divided into three stages: low-resolution training, high-resolution training, and high-quality video fine-tuning.
Similar to images, videos from the Internet usually include a significant amount of low-resolution ones.
Progressive training can effectively utilize videos of various resolutions.
Moreover, training at low resolution initially can equip the model with coarse-grained modeling capabilities, followed by high-resolution training to enhance its ability to capture fine details.
Compared to direct high-resolution training, staged training can also help reduce the overall training time.</p>
<figure width='384.2974pt' file='images/ive' extension='jpg' id-text='8' id='uid30' place='h'><head>The comparison between the initial generation states of extrapolation and interpolation when increasing the resolution with RoPE encoding. Extrapolation tends to generate multiple small, clear, and repetitive images, while interpolation generates a blurry large image.</head>
</figure>
<div3 id-text='3.2.0.7' id='uid31'><head>Extrapolation of Position Code.</head>
<p>When adapting low-resolution position encoding to high-resolution, we consider two different methods: interpolation and extrapolation. We show the effects of two methods in Figure <ref target='uid30'/>. Interpolation tens to preserve global information more effectively, whereas the extrapolation better retains local details. Given that RoPE is a relative position encoding, We chose the extrapolation to maintain the relative position between pixels.</p>
</div3>
<div3 id-text='3.2.0.8' id='uid32'><head>High-Quality Fine-Tuning.</head>
<p>Since the filtered pre-training data still contains a certain proportion of dirty data, such as subtitles, watermarks, and low-bitrate videos, we selected a subset of higher quality video data, accounting for 20% of the total dataset, for fine-tuning in the final stage. This step effectively removed generated subtitles and watermarks and slightly improved the visual quality. However, we also observed a slight degradation in the model's semantic ability.</p>
</div3></div1>
<div1 id-text='3.3' id='uid33'><head>Explicit Uniform Sampling</head>
<p> <cit><ref target='bid1'/></cit> defines the training objective of diffusion as</p>
<formula id-text='1' id='uid34' textype='equation' type='display'><math mode='display' xmlns='http://www.w3.org/1998/Math/MathML'><mrow><mspace width='3.33333pt'/><msub><mi>L</mi> <mi> simple </mi> </msub><mrow><mo>(</mo><mi>&#x3B8;</mi><mo>)</mo></mrow><mo>:</mo><mo>=</mo><msub><mi>&#x1D404;</mi> <mrow><mi>t</mi><mo>,</mo><msub><mi>x</mi> <mn>0</mn> </msub><mo>,</mo><mi>&#x3F5;</mi></mrow> </msub><msup><mfenced separators='' open='&#x02225;' close='&#x02225;'><mi>&#x3F5;</mi><mo>-</mo><msub><mi>&#x3F5;</mi> <mi>&#x3B8;</mi> </msub><mrow><mo>(</mo><msqrt><msub><mover accent='true'><mi>&#x3B1;</mi> <mo>&#xAF;</mo></mover> <mi>t</mi> </msub></msqrt><msub><mi>x</mi> <mn>0</mn> </msub><mo>+</mo><msqrt><mrow><mn>1</mn><mo>-</mo><msub><mover accent='true'><mi>&#x3B1;</mi> <mo>&#xAF;</mo></mover> <mi>t</mi> </msub></mrow></msqrt><mi>&#x3F5;</mi><mo>,</mo><mi>t</mi><mo>)</mo></mrow></mfenced> <mn>2</mn> </msup><mo>,</mo></mrow></math><texmath>~
L_\mathrm {simple}(\theta ) := \mathbf {E}_{t, x_0, \epsilon }{ \left\Vert  \epsilon - \epsilon _\theta (\sqrt{\bar{\alpha }_t} x_0 + \sqrt{1-\bar{\alpha }_t}\epsilon , t) \right\Vert ^2},
</texmath></formula>
<p noindent='true'>where <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>t</mi></math><texmath>t</texmath></formula> is uniformly distributed between 1 and T.
The common practice is for each rank in the data parallel group to uniformly sample a value between 1 and <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>T</mi></math><texmath>T</texmath></formula>, which is in theory equivalent to Equation <ref target='uid34'/>.
However, in practice, the results obtained from such random sampling are often not sufficiently uniform, and since the magnitude of the diffusion loss is related to the timesteps, this can lead to significant fluctuations in the loss.
Thus, we propose to use <hi rend='it'>Explicit Uniform Sampling</hi> to divide the range from 1 to <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>T</mi></math><texmath>T</texmath></formula> into <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math><texmath>n</texmath></formula> intervals, where <formula type='inline'><math xmlns='http://www.w3.org/1998/Math/MathML'><mi>n</mi></math><texmath>n</texmath></formula> is the number of ranks.
Each rank then uniformly samples within its respective interval.
This method ensures a more uniform distribution of timesteps.
As shown in Figure <ref target='uid8'/> (d), the loss curve from training with Explicit Uniform Sampling is noticeably more stable.</p>
<p>In addition, we compare the loss at each diffusion timestep alone between the two methods for a more precise comparison. We find that after using explicit uniform sampling, the loss at all timesteps decreased faster, indicating that this method can accelerate loss convergence.</p>
<p>We conducted ablation studies on some of the designs mentioned in Section <ref target='cid2'/> to verify their effectiveness.</p>
</div1>
<div1 id-text='3.4' id='uid35'><head>Position Embedding</head>
<p>First, we compared 3D RoPE with sinusoidal absolute position encoding. As shown in Figure <ref/>, the loss curve using 3D RoPE converges significantly faster than that with sinusoidal encoding.
Then we compared the use of 3D RoPE alone with the combination of 3D RoPE and learnable absolute position embedding. As shown in Figure <ref/>, the loss curves of both methods converge almost identically. For simplicity, we chose to use 3D RoPE alone.</p>
</div1>
<div1 id-text='3.5' id='uid36'><head>Expert Adaptive Layernorm</head>
<p>We experimented with different ways of incorporating experts: expert LayerNorm and MLP, and expert Layernorm only. Our experiments found that adding expert MLP does not effectively accelerate the model's convergence (Figure <ref/>). To reduce the model parameters, we only chose to use expert adaptive Layernorm.</p>
</div1></div0>
<div0 id-text='4' id='cid4'><head>Empirical Evaluation</head>
<p>In this section, we present the performance of CogVideoX through two primary methods: <hi rend='it'>automated metric evaluation</hi> and <hi rend='it'>human assessment</hi>. We train the CogVideoX models with different parameter sizes.
We show results for 2B and 5B for now, larger models are still in training.</p>
<p>To facilitate the development of text-to-video generation, we open-source the model weight at <xref url='https://github.com/THUDM/CogVideo'>https://<allowbreak/>github.<allowbreak/>com/<allowbreak/>THUDM/<allowbreak/>CogVideo</xref>.</p>
<div1 id-text='4.1' id='uid37'><head>Automated Metric Evaluation</head>
<div3 id-text='4.1.0.9' id='uid38'><head>Baselines.</head>
<p>We choose openly-accessible top-performing text-to-video models as baselines, including T2V-Turbo <cit><ref target='bid32'/></cit>, AnimateDiff <cit><ref target='bid15'/></cit>, VideoCrafter2 <cit><ref target='bid33'/></cit>, OpenSora <cit><ref target='bid34'/></cit>, Show-1 <cit><ref target='bid35'/></cit>, Gen-2 <cit><ref target='bid36'/></cit>, Pika <cit><ref target='bid37'/></cit>, and LaVie-2 <cit><ref target='bid38'/></cit>.</p>
</div3>
<div3 id-text='4.1.0.10' id='uid39'><head>Evaluation Metrics.</head>
<p>To evaluate the text-to-video generation, we employed several metrics from VBench <cit><ref target='bid39'/></cit>: <hi rend='it'>Human Action</hi>, <hi rend='it'>Scene</hi>, <hi rend='it'>Dynamic Degree</hi>, <hi rend='it'>Multiple Objects</hi>, and <hi rend='it'>Appearance Style</hi>.
VBench is a suite of tools designed to automatically assess the quality of generated videos. We have selected certain metrics from VBench, excluding others that do not align with our evaluation needs.
For example, the color metric, intended to measure the presence of objects corresponding to specific colors across frames in the generated video, assesses the model's quality by calculating the probability.
However, this metric may mislead video generation models that exhibit greater variation, thus it is not to include it in our evaluation.</p>
<p>For longer-generated videos, some models might produce videos with minimal changes between frames to obtain higher scores, but these videos lack rich content.
Therefore, a metric for evaluating the dynamism of the video becomes more important.
To address this, we employ two video evaluation tools: <hi rend='it'>Dynamic Quality</hi> from Devil <cit><ref target='bid40'/></cit> and <hi rend='it'>GPT4o-MTScore</hi> from ChronoMagic <cit><ref target='bid41'/></cit>, which focus more on the dynamic characteristics of videos.
<hi rend='it'>Dynamic Quality</hi> is defined by the integration of various quality metrics with dynamic scores, mitigating biases arising from negative correlations between video dynamics and video quality.
ChronoMagic, for instance, introduces GPT4o-MTScore, a metric designed to measure the metamorphic amplitude of time-lapse videos, such as those depicting physical, biological, and meteorological changes.
This metric using GPT-4o <cit><ref target='bid42'/></cit> to score the degree of change, providing a fine-grained assessment of video dynamism.</p>
</div3>
<div3 id-text='4.1.0.11' id='uid40'><head>Results.</head>
<p>Table <ref target='uid43'/> provides the performance comparison of CogVideoX and other models.
CogVideoX achieves the best performance in five out of the seven metrics and shows competitive results in the remaining two metrics.
These results demonstrate that the model not only excels in video generation quality but also outperforms previous models in handling various complex dynamic scenes.
In addition, Figure <ref target='uid1'/> presents a radar chart that visually illustrates the performance advantages of CogVideoX.</p>
<figure width='427.0pt' file='images/t2v/goodcase1' extension='jpg' id-text='9' id='uid41' place='ht'><head>Text to video showcases. The displayed prompt will be upsampled before being fed into the model. The generated videos contain large motion and can produce various video styles.</head>
</figure>
<figure width='418.45818pt' file='images/t2v/goodcase2' extension='jpg' id-text='10' id='uid42' place='ht'><head>Text to video showcases.</head>
</figure>
<table rend='display' id-text='1' id='uid43' place='t'><head>Evaluation results.</head>
<unexpected><hi rend='small'><table rend='inline'><row><cell halign='center'>Models</cell>
<cell halign='center'>Human</cell>
</row><row><cell halign='center'>Action</cell>
<cell halign='center'>Scene</cell>
<cell halign='center'>Dynamic</cell>
</row><row><cell halign='center'>Degree</cell>
<cell halign='center'>Multiple</cell>
</row><row><cell halign='center'>Objects</cell>
<cell halign='center'>Appearance</cell>
</row><row><cell halign='center'>Style</cell>
<cell halign='center'>Dynamic</cell>
</row><row><cell halign='center'>Quality</cell>
<cell halign='center'>GPT4o-MT</cell>
</row><row><cell halign='center'>Score</cell>
</row><row><cell halign='center'>T2V-Turbo</cell>
<cell halign='center'>95.2</cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>55.58</hi></hi><hi rend='small'/></cell>
<cell halign='center'>49.17</cell>
<cell halign='center'>54.65</cell>
<cell halign='center'>24.42</cell>
<cell halign='center'>–</cell>
<cell halign='center'>–</cell>
</row><row><cell halign='center'>AnimateDiff</cell>
<cell halign='center'>92.6</cell>
<cell halign='center'>50.19</cell>
<cell halign='center'>40.83</cell>
<cell halign='center'>36.88</cell>
<cell halign='center'>22.42</cell>
<cell halign='center'>–</cell>
<cell halign='center'>2.62</cell>
</row><row><cell halign='center'>VideoCrafter-2.0</cell>
<cell halign='center'>95.0</cell>
<cell halign='center'>55.29</cell>
<cell halign='center'>42.50</cell>
<cell halign='center'>40.66</cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>25.13</hi></hi><hi rend='small'/></cell>
<cell halign='center'>43.6</cell>
<cell halign='center'>2.68</cell>
</row><row><cell halign='center'>OpenSora V1.2</cell>
<cell halign='center'>85.8</cell>
<cell halign='center'>42.47</cell>
<cell halign='center'>47.22</cell>
<cell halign='center'>58.41</cell>
<cell halign='center'>23.89</cell>
<cell halign='center'>63.7</cell>
<cell halign='center'>2.52</cell>
</row><row><cell halign='center'>Show-1</cell>
<cell halign='center'>95.6</cell>
<cell halign='center'>47.03</cell>
<cell halign='center'>44.44</cell>
<cell halign='center'>45.47</cell>
<cell halign='center'>23.06</cell>
<cell halign='center'>57.7</cell>
<cell halign='center'>–</cell>
</row><row><cell halign='center'>Gen-2</cell>
<cell halign='center'>89.2</cell>
<cell halign='center'>48.91</cell>
<cell halign='center'>18.89</cell>
<cell halign='center'>55.47</cell>
<cell halign='center'>19.34</cell>
<cell halign='center'>43.6</cell>
<cell halign='center'>2.62</cell>
</row><row><cell halign='center'>Pika</cell>
<cell halign='center'>88.0</cell>
<cell halign='center'>44.80</cell>
<cell halign='center'>37.22</cell>
<cell halign='center'>46.69</cell>
<cell halign='center'>21.89</cell>
<cell halign='center'>52.1</cell>
<cell halign='center'>2.48</cell>
</row><row bottom-border='true'><cell halign='center'>LaVie-2</cell>
<cell halign='center'>96.4</cell>
<cell halign='center'>49.59</cell>
<cell halign='center'>31.11</cell>
<cell halign='center'>64.88</cell>
<cell halign='center'>25.09</cell>
<cell halign='center'>–</cell>
<cell halign='center'>2.46</cell>
</row><row><cell halign='center'><hi rend='small'><hi rend='bold'>CogVideoX-2B</hi></hi><hi rend='small'/></cell>
<cell halign='center'>88.0</cell>
<cell halign='center'>39.94</cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>63.33</hi></hi><hi rend='small'/></cell>
<cell halign='center'>53.70</cell>
<cell halign='center'>23.67</cell>
<cell halign='center'>57.7</cell>
<cell halign='center'>3.09</cell>
</row><row><cell halign='center'><hi rend='small'><hi rend='bold'>CogVideoX-5B</hi></hi><hi rend='small'/></cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>96.8</hi></hi><hi rend='small'/></cell>
<cell halign='center'>55.44</cell>
<cell halign='center'>62.22</cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>70.95</hi></hi><hi rend='small'/></cell>
<cell halign='center'>24.44</cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>69.5</hi></hi><hi rend='small'/></cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>3.36</hi></hi><hi rend='small'/></cell>
</row></table></hi></unexpected></table>
</div3></div1>
<div1 id-text='4.2' id='uid44'><head>Human Evaluation</head>
<p>In addition to automated scoring mechanisms, a comparative analysis between the Kling <cit><ref target='bid43'/></cit> and CogVideoX is conducted with manual evaluation.
One hundred meticulously crafted prompts are used for human evaluators, characterized by their broad distribution, clear articulation, and well-defined conceptual scope.
We randomize videos for blind evalution.
A panel of evaluators is instructed to assign scores for each detail on a scale from zero to one, with the overall total score rated on a scale from 0 to 5, where higher scores reflect better video quality.
To better complement automated evaluation, human evaluation emphasizes the instruction-following capability: the total score cannot exceed 2 if the generated video fails to follow the instruction.</p>
<p>The results shown in Table <ref target='uid45'/> indicate that CogVideoX wins the human preference over Kling across all aspects.
More details about human evaluation are shown in Appendix <ref/>.</p>
<table rend='display' id-text='2' id='uid45' place='!ht'><head><hi rend='small'>Human evaluation between CogVideoX and Kling.</hi></head>
<unexpected><hi rend='small'>


<resizebox width='320.25pt'>
<table rend='inline'><row><cell halign='center'>Model</cell>
<cell halign='center'>Sensory</cell>
</row><row><cell halign='center'>Quality</cell>
<cell halign='center'>Instruction</cell>
</row><row><cell halign='center'>Following</cell>
<cell halign='center'>Physics</cell>
</row><row><cell halign='center'>Simulation</cell>
<cell halign='center'>Cover</cell>
</row><row><cell halign='center'>Quality</cell>
<cell halign='center'>Total</cell>
</row><row><cell halign='center'>Score</cell>
</row><row><cell halign='center'>Kling</cell>
<cell halign='center'>0.638</cell>
<cell halign='center'>0.367</cell>
<cell halign='center'>0.561</cell>
<cell halign='center'>0.668</cell>
<cell halign='center'>2.17</cell>
</row><row><cell halign='center'><hi rend='small'><hi rend='bold'>CogVideoX-5B</hi></hi><hi rend='small'/></cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>0.722</hi></hi><hi rend='small'/></cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>0.495</hi></hi><hi rend='small'/></cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>0.667</hi></hi><hi rend='small'/></cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>0.712</hi></hi><hi rend='small'/></cell>
<cell halign='center'><hi rend='small'><hi rend='bold'>2.74</hi></hi><hi rend='small'/></cell>
</row></table>
</resizebox></hi></unexpected></table>
<div2 rend='nonumber'><head>Acknowledgments</head>
<p>We would like to thank all the data annotators, infra operating staffs, collaborators, and partners as well as everyone at Zhipu AI and Tsinghua University not explicitly mentioned in the report who have provided support, feedback, and contributed to CogVideoX.
We would also like to greatly thank BiliBili for data support.</p>
<Bibliography><p noindent='true'><bibitem id='bid37'/>Pika beta.
2023.
URL <xref url='https://pika.art/home'>https://<allowbreak/>pika.<allowbreak/>art/<allowbreak/>home</xref>.</p>
<p noindent='true'><bibitem id='bid28'/>Josh Achiam, Steven Adler, Sandhini Agarwal, Lama Ahmad, Ilge Akkaya, Florencia Leoni Aleman, Diogo Almeida, Janko Altenschmidt, Sam Altman, Shyamal Anadkat, et al.
Gpt-4 technical report.
<hi rend='it'>arXiv preprint arXiv:2303.08774</hi>, 2023.</p>
<p noindent='true'><bibitem id='bid16'/>AI@Meta.
Llama 3 model card.
2024.
URL <xref url='https://github.com/meta-llama/llama3/blob/main/MODEL_CARD.md'>https://<allowbreak/>github.<allowbreak/>com/<allowbreak/>meta-llama/<allowbreak/>llama3/<allowbreak/>blob/<allowbreak/>main/<allowbreak/>MODEL_CARD.<allowbreak/>md</xref>.</p>
<p noindent='true'><bibitem id='bid17'/>Yushi Bai, Xin Lv, Jiajie Zhang, Yuze He, Ji Qi, Lei Hou, Jie Tang, Yuxiao Dong, and Juanzi Li.
Longalign: A recipe for long context alignment of large language models.
<hi rend='it'>arXiv preprint arXiv:2401.18058</hi>, 2024.</p>
<p noindent='true'><bibitem id='bid23'/>Max Bain, Arsha Nagrani, Gül Varol, and Andrew Zisserman.
Frozen in time: A joint video and image encoder for end-to-end retrieval.
In <hi rend='it'>Proceedings of the IEEE/CVF international conference on computer vision</hi>, pp. 1728–1738, 2021.</p>
<p noindent='true'><bibitem id='bid44'/>James Betker, Gabriel Goh, Li Jing, Tim Brooks, Jianfeng Wang, Linjie Li, Long Ouyang, Juntang Zhuang, Joyce Lee, Yufei Guo, et al.
Improving image generation with better captions.
<hi rend='it'>Computer Science. https://cdn. openai. com/papers/dall-e-3. pdf</hi>, 2(3):8, 2023.</p>
<p noindent='true'><bibitem id='bid8'/>Andreas Blattmann, Tim Dockhorn, Sumith Kulal, Daniel Mendelevitch, Maciej Kilian, Dominik Lorenz, Yam Levi, Zion English, Vikram Voleti, Adam Letts, et al.
Stable video diffusion: Scaling latent video diffusion models to large datasets.
<hi rend='it'>arXiv preprint arXiv:2311.15127</hi>, 2023.</p>
<p noindent='true'><bibitem id='bid33'/>Haoxin Chen, Yong Zhang, Xiaodong Cun, Menghan Xia, Xintao Wang, Chao Weng, and Ying Shan.
Videocrafter2: Overcoming data limitations for high-quality video diffusion models, 2024a.</p>
<p noindent='true'><bibitem id='bid21'/>Tsai-Shien Chen, Aliaksandr Siarohin, Willi Menapace, Ekaterina Deyneka, Hsiang-wei Chao, Byung Eun Jeon, Yuwei Fang, Hsin-Ying Lee, Jian Ren, Ming-Hsuan Yang, et al.
Panda-70m: Captioning 70m videos with multiple cross-modality teachers.
In <hi rend='it'>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</hi>, pp. 13320–13331, 2024b.</p>
<p noindent='true'><bibitem id='bid19'/>Tri Dao, Dan Fu, Stefano Ermon, Atri Rudra, and Christopher Ré.
Flashattention: Fast and memory-efficient exact attention with io-awareness.
<hi rend='it'>Advances in Neural Information Processing Systems</hi>, 35:16344–16359, 2022.</p>
<p noindent='true'><bibitem id='bid31'/>Mostafa Dehghani, Basil Mustafa, Josip Djolonga, Jonathan Heek, Matthias Minderer, Mathilde Caron, Andreas Steiner, Joan Puigcerver, Robert Geirhos, Ibrahim M Alabdulmohsin, et al.
Patch n’pack: Navit, a vision transformer for any aspect ratio and resolution.
<hi rend='it'>Advances in Neural Information Processing Systems</hi>, 36, 2024.</p>
<p noindent='true'><bibitem id='bid12'/>Patrick Esser, Robin Rombach, and Bjorn Ommer.
Taming transformers for high-resolution image synthesis.
In <hi rend='it'>Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</hi>, pp. 12873–12883, 2021.</p>
<p noindent='true'><bibitem id='bid25'/>Patrick Esser, Sumith Kulal, Andreas Blattmann, Rahim Entezari, Jonas Müller, Harry Saini, Yam Levi, Dominik Lorenz, Axel Sauer, Frederic Boesel, et al.
Scaling rectified flow transformers for high-resolution image synthesis.
In <hi rend='it'>Forty-first International Conference on Machine Learning</hi>, 2024.</p>
<p noindent='true'><bibitem id='bid15'/>Yuwei Guo, Ceyuan Yang, Anyi Rao, Zhengyang Liang, Yaohui Wang, Yu Qiao, Maneesh Agrawala, Dahua Lin, and Bo Dai.
Animatediff: Animate your personalized text-to-image diffusion models without specific tuning.
<hi rend='it'>arXiv preprint arXiv:2307.04725</hi>, 2023.</p>
<p noindent='true'><bibitem id='bid1'/>Jonathan Ho, Ajay Jain, and Pieter Abbeel.
Denoising diffusion probabilistic models.
<hi rend='it'>Advances in neural information processing systems</hi>, 33:6840–6851, 2020.</p>
<p noindent='true'><bibitem id='bid5'/>Jonathan Ho, William Chan, Chitwan Saharia, Jay Whang, Ruiqi Gao, Alexey Gritsenko, Diederik P Kingma, Ben Poole, Mohammad Norouzi, David J Fleet, et al.
Imagen video: High definition video generation with diffusion models.
<hi rend='it'>arXiv preprint arXiv:2210.02303</hi>, 2022.</p>
<p noindent='true'><bibitem id='bid2'/>Wenyi Hong, Ming Ding, Wendi Zheng, Xinghan Liu, and Jie Tang.
Cogvideo: Large-scale pretraining for text-to-video generation via transformers.
<hi rend='it'>arXiv preprint arXiv:2205.15868</hi>, 2022.</p>
<p noindent='true'><bibitem id='bid39'/>Ziqi Huang, Yinan He, Jiashuo Yu, Fan Zhang, Chenyang Si, Yuming Jiang, Yuanhan Zhang, Tianxing Wu, Qingyang Jin, Nattapol Chanpaisit, Yaohui Wang, Xinyuan Chen, Limin Wang, Dahua Lin, Yu Qiao, and Ziwei Liu.
VBench: Comprehensive benchmark suite for video generative models.
In <hi rend='it'>Proceedings of the IEEE/CVF Conference on Computer Vision and Pattern Recognition</hi>, 2024.</p>
<p noindent='true'><bibitem id='bid32'/>Jiachen Li, Weixi Feng, Tsu-Jui Fu, Xinyi Wang, Sugato Basu, Wenhu Chen, and William Yang Wang.
T2v-turbo: Breaking the quality bottleneck of video consistency model with mixed reward feedback.
<hi rend='it'>arXiv preprint arXiv:2405.18750</hi>, 2024.</p>
<p noindent='true'><bibitem id='bid40'/>Mingxiang Liao, Hannan Lu, Xinyu Zhang, Fang Wan, Tianyu Wang, Yuzhong Zhao, Wangmeng Zuo, Qixiang Ye, and Jingdong Wang.
Evaluation of text-to-video generation models: A dynamics perspective, 2024.
URL <xref url='https://arxiv.org/abs/2407.01094'>https://<allowbreak/>arxiv.<allowbreak/>org/<allowbreak/>abs/<allowbreak/>2407.<allowbreak/>01094</xref>.</p>
<p noindent='true'><bibitem id='bid30'/>Shanchuan Lin, Bingchen Liu, Jiashi Li, and Xiao Yang.
Common diffusion noise schedules and sample steps are flawed.
In <hi rend='it'>Proceedings of the IEEE/CVF winter conference on applications of computer vision</hi>, pp. 5404–5411, 2024.</p>
<p noindent='true'><bibitem id='bid22'/>Tsung-Yi Lin, Michael Maire, Serge Belongie, James Hays, Pietro Perona, Deva Ramanan, Piotr Dollár, and C Lawrence Zitnick.
Microsoft coco: Common objects in context.
In <hi rend='it'>Computer Vision–ECCV 2014: 13th European Conference, Zurich, Switzerland, September 6-12, 2014, Proceedings, Part V 13</hi>, pp. 740–755. Springer, 2014.</p>
<p noindent='true'><bibitem id='bid42'/>OpenAI.
Gpt-4o.
2024a.</p>
<p noindent='true'><bibitem id='bid7'/>OpenAI.
Sora.
2024b.
URL <xref url='https://openai.com/index/sora/'>https://<allowbreak/>openai.<allowbreak/>com/<allowbreak/>index/<allowbreak/>sora/<allowbreak/></xref>.</p>
<p noindent='true'><bibitem id='bid6'/>William Peebles and Saining Xie.
Scalable diffusion models with transformers.
In <hi rend='it'>Proceedings of the IEEE/CVF International Conference on Computer Vision</hi>, pp. 4195–4205, 2023.</p>
<p noindent='true'><bibitem id='bid9'/>Colin Raffel, Noam Shazeer, Adam Roberts, Katherine Lee, Sharan Narang, Michael Matena, Yanqi Zhou, Wei Li, and Peter J Liu.
Exploring the limits of transfer learning with a unified text-to-text transformer.
<hi rend='it'>Journal of machine learning research</hi>, 21(140):1–67, 2020.</p>
<p noindent='true'><bibitem id='bid11'/>Robin Rombach, Andreas Blattmann, Dominik Lorenz, Patrick Esser, and Björn Ommer.
High-resolution image synthesis with latent diffusion models.
In <hi rend='it'>Proceedings of the IEEE/CVF conference on computer vision and pattern recognition</hi>, pp. 10684–10695, 2022.</p>
<p noindent='true'><bibitem id='bid36'/>runway.
Gen-2.
2023.
URL <xref url='https://runwayml.com/ai-tools/gen-2-text-to-video'>https://<allowbreak/>runwayml.<allowbreak/>com/<allowbreak/>ai-tools/<allowbreak/>gen-2-text-to-video</xref>.</p>
<p noindent='true'><bibitem id='bid29'/>Tim Salimans and Jonathan Ho.
Progressive distillation for fast sampling of diffusion models.
<hi rend='it'>arXiv preprint arXiv:2202.00512</hi>, 2022.</p>
<p noindent='true'><bibitem id='bid4'/>Uriel Singer, Adam Polyak, Thomas Hayes, Xi Yin, Jie An, Songyang Zhang, Qiyuan Hu, Harry Yang, Oron Ashual, Oran Gafni, et al.
Make-a-video: Text-to-video generation without text-video data.
<hi rend='it'>arXiv preprint arXiv:2209.14792</hi>, 2022.</p>
<p noindent='true'><bibitem id='bid14'/>Jianlin Su, Murtadha Ahmed, Yu Lu, Shengfeng Pan, Wen Bo, and Yunfeng Liu.
Roformer: Enhanced transformer with rotary position embedding.
<hi rend='it'>Neurocomputing</hi>, 568:127063, 2024.</p>
<p noindent='true'><bibitem id='bid43'/>Kuaishou AI Team.
Kling.
2024.
URL <xref url='https://kling.kuaishou.com/en'>https://<allowbreak/>kling.<allowbreak/>kuaishou.<allowbreak/>com/<allowbreak/>en</xref>.</p>
<p noindent='true'><bibitem id='bid27'/>Hugo Touvron, Louis Martin, Kevin Stone, Peter Albert, Amjad Almahairi, Yasmine Babaei, Nikolay Bashlykov, Soumya Batra, Prajjwal Bhargava, Shruti Bhosale, et al.
Llama 2: Open foundation and fine-tuned chat models.
<hi rend='it'>arXiv preprint arXiv:2307.09288</hi>, 2023.</p>
<p noindent='true'><bibitem id='bid0'/>Ashish Vaswani, Noam Shazeer, Niki Parmar, Jakob Uszkoreit, Llion Jones, Aidan N Gomez, Łukasz Kaiser, and Illia Polosukhin.
Attention is all you need.
<hi rend='it'>Advances in neural information processing systems</hi>, 30, 2017.</p>
<p noindent='true'><bibitem id='bid3'/>Ruben Villegas, Mohammad Babaeizadeh, Pieter-Jan Kindermans, Hernan Moraldo, Han Zhang, Mohammad Taghi Saffar, Santiago Castro, Julius Kunze, and Dumitru Erhan.
Phenaki: Variable length video generation from open domain textual descriptions.
In <hi rend='it'>International Conference on Learning Representations</hi>, 2022.</p>
<p noindent='true'><bibitem id='bid24'/>Weihan Wang, Qingsong Lv, Wenmeng Yu, Wenyi Hong, Ji Qi, Yan Wang, Junhui Ji, Zhuoyi Yang, Lei Zhao, Xixuan Song, et al.
Cogvlm: Visual expert for pretrained language models.
<hi rend='it'>arXiv preprint arXiv:2311.03079</hi>, 2023a.</p>
<p noindent='true'><bibitem id='bid38'/>Yaohui Wang, Xinyuan Chen, Xin Ma, Shangchen Zhou, Ziqi Huang, Yi Wang, Ceyuan Yang, Yinan He, Jiashuo Yu, Peiqing Yang, et al.
Lavie: High-quality video generation with cascaded latent diffusion models.
<hi rend='it'>arXiv preprint arXiv:2309.15103</hi>, 2023b.</p>
<p noindent='true'><bibitem id='bid18'/>Wenhan Xiong, Jingyu Liu, Igor Molybog, Hejia Zhang, Prajjwal Bhargava, Rui Hou, Louis Martin, Rashi Rungta, Karthik Abinav Sankararaman, Barlas Oguz, et al.
Effective long-context scaling of foundation models.
<hi rend='it'>arXiv preprint arXiv:2309.16039</hi>, 2023.</p>
<p noindent='true'><bibitem id='bid10'/>Lijun Yu, José Lezama, Nitesh B Gundavarapu, Luca Versari, Kihyuk Sohn, David Minnen, Yong Cheng, Agrim Gupta, Xiuye Gu, Alexander G Hauptmann, et al.
Language model beats diffusion–tokenizer is key to visual generation.
<hi rend='it'>arXiv preprint arXiv:2310.05737</hi>, 2023.</p>
<p noindent='true'><bibitem id='bid41'/>Shenghai Yuan, Jinfa Huang, Yongqi Xu, Yaoyang Liu, Shaofeng Zhang, Yujun Shi, Ruijie Zhu, Xinhua Cheng, Jiebo Luo, and Li Yuan.
Chronomagic-bench: A benchmark for metamorphic evaluation of text-to-time-lapse video generation.
<hi rend='it'>arXiv preprint arXiv:2406.18522</hi>, 2024.</p>
<p noindent='true'><bibitem id='bid35'/>David Junhao Zhang, Jay Zhangjie Wu, Jia-Wei Liu, Rui Zhao, Lingmin Ran, Yuchao Gu, Difei Gao, and Mike Zheng Shou.
Show-1: Marrying pixel and latent diffusion models for text-to-video generation.
<hi rend='it'>arXiv preprint arXiv:2309.15818</hi>, 2023a.</p>
<p noindent='true'><bibitem id='bid20'/>Hang Zhang, Xin Li, and Lidong Bing.
Video-llama: An instruction-tuned audio-visual language model for video understanding.
<hi rend='it'>arXiv preprint arXiv:2306.02858</hi>, 2023b.</p>
<p noindent='true'><bibitem id='bid13'/>Richard Zhang, Phillip Isola, Alexei A Efros, Eli Shechtman, and Oliver Wang.
The unreasonable effectiveness of deep features as a perceptual metric.
In <hi rend='it'>Proceedings of the IEEE conference on computer vision and pattern recognition</hi>, pp. 586–595, 2018.</p>
<p noindent='true'><bibitem id='bid26'/>Wendi Zheng, Jiayan Teng, Zhuoyi Yang, Weihan Wang, Jidong Chen, Xiaotao Gu, Yuxiao Dong, Ming Ding, and Jie Tang.
Cogview3: Finer and faster text-to-image generation via relay diffusion.
<hi rend='it'>arXiv preprint arXiv:2403.05121</hi>, 2024a.</p>
<p noindent='true'><bibitem id='bid34'/>Zangwei Zheng, Xiangyu Peng, Tianji Yang, Chenhui Shen, Shenggui Li, Hongxin Liu, Yukun Zhou, Tianyi Li, and Yang You.
Open-sora: Democratizing efficient video production for all, March 2024b.
URL <xref url='https://github.com/hpcaitech/Open-Sora'>https://<allowbreak/>github.<allowbreak/>com/<allowbreak/>hpcaitech/<allowbreak/>Open-Sora</xref>.</p>
</Bibliography></div2></div1></div0></std>
